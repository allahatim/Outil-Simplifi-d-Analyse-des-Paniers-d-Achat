import express from 'express';
import { getTotalSalesForPeriod, getTopSellingProducts, getSalesByCategory, getProductsWithDetails } from '../services/analyticsService';

const router = express.Router();
router.get('/sales/total/:period', async (req, res) => {
  try {
    const { period } = req.params || '7_days';
    const totalSales = await getTotalSalesForPeriod(period as '7_days' | '30_days' | '12_months');
    res.status(200).json({ totalSales });
  } catch (error) {
    res.status(500).json({ message: 'Error fetching total sales', error });
  }
});
router.get('/sales/top-products/:period', async (req, res) => {
  try {
    const { period } = req.params || '7_days';
    const topProducts = await getTopSellingProducts(period as '7_days' | '30_days' | '12_months');
    res.status(200).json({ topProducts });
  } catch (error) {
    res.status(500).json({ message: 'Error fetching top-selling products', error });
  }
});
router.get('/sales/category/:period', async (req, res) => {
  try {
    const { period } = req.params || '7_days';
    const salesByCategory = await getSalesByCategory(period as '7_days' | '30_days' | '12_months');
    res.status(200).json({ salesByCategory });
  } catch (error) {
    res.status(500).json({ message: 'Error fetching sales by category', error });
  }
});
router.get('/products/details', async (req, res) => {
  try {
    const products = await getProductsWithDetails();
    res.status(200).json({ products });
  } catch (error) {
    res.status(500).json({ message: 'Error fetching product details', error });
  }
});

export default router;
